# 모두의 핏 앱 기능 정의서 v2

## 1. 문서 개요

### 1.1 프로젝트 정보
- **프로젝트명**: 모두의 핏 (All4Fit) 앱
- **버전**: 2.1
- **작성일**: 2025년 1월
- **대상 플랫폼**: iOS, Android

### 1.2 문서 목적
본 문서는 DB 설계서와 API 명세서를 기반으로 모두의 핏 앱의 1차 개발 범위 기능을 체계적으로 정의하고, 파트너 등록 통합 플로우를 추가한 v2 버전입니다.

### 1.3 개발 범위
- **1차 개발 v2**: 파트너 등록 통합, 역할 기반 권한, 지도 자기 위치 이동 기능 추가
- **읽기 전용**: 시설운영자/지도자 편집 기능 없음, 공공데이터 포털 기반 시설 정보 표시
- **제외 기능**: 예약, 리뷰, 찜, 문의, 알림, 커뮤니티, 시설/지도자 편집 (2차 개발 예정)

### 1.4 개발 우선순위
| 우선순위 | 기능 그룹 | 세부 기능 |
|---------|----------|-----------|
| **P0 (최우선)** | 파트너 등록 통합 | 통합 파트너 등록 플로우, 역할 선택 | 
| **P0 (최우선)** | 인증 시스템 | 통합 로그인, 회원가입, 카카오 로그인 | 
| **P0 (최우선)** | 기본 인프라 | DB 설계, API 기본 구조, 보안 시스템 | 
| **P1 (높음)** | 역할 기반 권한 | 다중 권한 지원, 역할별 접근 제어 |
| **P1 (높음)** | 위치 기반 서비스 | GPS 위치 인식, 주소 변환, 위치 변경 | 
| **P1 (높음)** | 공공데이터 연동 | 시설 정보 조회, 데이터 파싱, API 연동 | 
| **P1 (높음)** | 시설 검색/조회 | 시설 리스트, 상세 정보, 필터링 | 
| **P2 (중간)** | 지도 기능 | 지도 뷰, 시설 마커, 지도 컨트롤, 자기 위치 이동 | 
| **P2 (중간)** | 사용자 관리 | 프로필 수정, 계정 관리, 마이페이지 | 
| **P3 (낮음)** | 부가 기능 | 비밀번호 찾기, 약관 정책, 계정 관리 | 

## 2. 전체 앱 구조

### 2.1 앱 아키텍처 (IA 기반)
```
모두의 핏 앱 (ROOT)
├── 인증 영역 (AUTH) - 비로그인 상태
│   ├── 로그인 메인 (LOGIN_MAIN)
│   │   ├── 통합 로그인 (LOGIN_UNIFIED)
│   │   ├── 카카오 로그인 (LOGIN_KAKAO)
│   │   ├── 비밀번호 찾기 (PW_FIND)
│   │   │   ├── 이름 입력 (PW_FIND_NAME)
│   │   │   ├── 전화번호 인증 (PW_FIND_PHONE)
│   │   │   ├── 비밀번호 재설정 (PW_RESET)
│   │   │   └── 재설정 완료 (PW_RESET_COMPLETE)
│   │   ├── 회원가입 (SIGNUP) - 일반 사용자만
│   │   │   ├── 기본정보 입력 (SIGNUP_BASIC)
│   │   │   │   ├── 이름 입력 (SIGNUP_NAME)
│   │   │   │   ├── 이메일/전화번호 입력 (SIGNUP_EMAIL_PHONE)
│   │   │   │   └── 비밀번호 설정 (SIGNUP_PASSWORD)
│   │   │   ├── 약관 동의 (SIGNUP_TERMS)
│   │   │   ├── 사용자 설정 (SIGNUP_USER_SETTING)
│   │   │   │   ├── 닉네임 설정 (SIGNUP_NICKNAME)
│   │   │   │   ├── 생년월일 입력 (SIGNUP_BIRTH)
│   │   │   │   ├── 성별 선택 (SIGNUP_GENDER)
│   │   │   │   └── 거주지역 설정 (SIGNUP_LOCATION)
│   │   │   └── 가입 완료 (SIGNUP_COMPLETE)
│   │   └── 파트너 등록 (PARTNER_REGISTRATION) - NEW
│   │       ├── 기본정보 입력 (PARTNER_SIGNUP_BASIC)
│   │       │   ├── 이름 입력 (PARTNER_SIGNUP_NAME)
│   │       │   ├── 이메일/전화번호 입력 (PARTNER_SIGNUP_EMAIL_PHONE)
│   │       │   └── 비밀번호 설정 (PARTNER_SIGNUP_PASSWORD)
│   │       ├── 약관 동의 (PARTNER_SIGNUP_TERMS)
│   │       ├── 사용자 설정 (PARTNER_SIGNUP_USER_SETTING)
│   │       │   ├── 닉네임 설정 (PARTNER_SIGNUP_NICKNAME)
│   │       │   ├── 생년월일 입력 (PARTNER_SIGNUP_BIRTH)
│   │       │   ├── 성별 선택 (PARTNER_SIGNUP_GENDER)
│   │       │   └── 거주지역 설정 (PARTNER_SIGNUP_LOCATION)
│   │       └── 파트너 타입 선택 (PARTNER_TYPE_SELECT) - NEW
│   │           ├── 지도자 등록 (INSTRUCTOR_PARTNER_SIGNUP)
│   │           │   ├── 기본 정보 + 자격 정보 업로드 (INSTRUCTOR_SIGNUP_INFO)
│   │           │   ├── 포트폴리오 작성 (INSTRUCTOR_REGISTER_PORTFOLIO)
│   │           │   ├── 소속 시설 등록 (INSTRUCTOR_REGISTER_FACILITY)
│   │           │   │   ├── 시설명 입력 (INSTRUCTOR_FACILITY_NAME)
│   │           │   │   ├── 시설 주소 입력 (INSTRUCTOR_FACILITY_ADDRESS)
│   │           │   │   └── 위치 확인 (INSTRUCTOR_FACILITY_LOCATION)
│   │           │   └── 등록 완료 (INSTRUCTOR_REGISTER_COMPLETE)
│   │           ├── 시설 운영자 등록 (FACILITY_PARTNER_SIGNUP)
│   │           │   ├── 기본 정보 + 증빙서류 업로드 (FACILITY_OPERATOR_SIGNUP_INFO)
│   │           │   ├── 시설 등록 - 기본 정보 (FACILITY_OPERATOR_REGISTER_BASIC)
│   │           │   │   ├── 시설명 입력 (FACILITY_NAME_INPUT)
│   │           │   │   ├── 시설 주소 입력 (FACILITY_ADDRESS_INPUT)
│   │           │   │   ├── 시설 유형 선택 (FACILITY_TYPE_SELECT)
│   │           │   │   └── 운동 종목 선택 (FACILITY_SPORTS_SELECT)
│   │           │   ├── 운영 시간 및 정보 (FACILITY_OPERATOR_REGISTER_HOURS)
│   │           │   └── 등록 완료 (FACILITY_OPERATOR_REGISTER_COMPLETE)
│   │           └── 지도자·시설 통합 등록 (INTEGRATED_PARTNER_SIGNUP) - NEW
│   │               ├── 지도자 정보 입력 + 자격증 업로드 (INTEGRATED_INSTRUCTOR_INFO)
│   │               ├── 시설 정보 입력 + 사업자등록증 업로드 (INTEGRATED_FACILITY_INFO)
│   │               └── 통합 등록 완료 (INTEGRATED_REGISTER_COMPLETE)
├── 메인 앱 (MAIN) - 로그인 상태
│   ├── 홈 탭 (HOME_TAB)
│   │   ├── 현재 위치 표시 (HOME_LOCATION)
│   │   │   └── 위치 변경 (HOME_LOCATION_CHANGE)
│   │   ├── 시설 검색창 (HOME_SEARCH)
│   │   ├── 운동 분야 선택 (HOME_SPORTS)
│   │   │   └── 구기 종목 선택 (HOME_SPORTS_DETAIL)
│   │   │       └── 시설 리스트 (FACILITY_LIST)
│   │   │           ├── 정렬 옵션 (FACILITY_LIST_SORT)
│   │   │           ├── 필터링 (FACILITY_LIST_FILTER)
│   │   │           ├── 지도 뷰 (FACILITY_LIST_MAP)
│   │   │           └── 시설 상세 (FACILITY_DETAIL)
│   │   │               └── 지도자 탭 (INSTRUCTOR_TAB)
│   │   └── 근처 인기 시설 (HOME_POPULAR)
│   ├── 지도 탭 (MAP_TAB) - ENHANCED
│   │   ├── 지도 뷰 (MAP_VIEW)
│   │   ├── 자기 위치 이동 (MAP_MY_LOCATION) - NEW
│   │   ├── 지도 컨트롤 (MAP_CONTROL)
│   │   └── 시설 정보 (MAP_FACILITY_INFO)
│   └── 마이페이지 탭 (MYPAGE_TAB)
│       └── 마이페이지 메인 (MYPAGE_MAIN)
│           ├── 프로필 수정 (MYPAGE_PROFILE_EDIT)
│           ├── 아이디/비밀번호 변경 (MYPAGE_ACCOUNT_CHANGE)
│           │   ├── 전화번호 변경 (MYPAGE_PHONE_CHANGE)
│           │   ├── 이메일 변경 (MYPAGE_EMAIL_CHANGE)
│           │   └── 비밀번호 변경 (MYPAGE_PASSWORD_CHANGE)
│           └── 더보기 (MYPAGE_MORE)
│               ├── 약관 정책 (MYPAGE_TERMS)
│               │   ├── 서비스 이용 약관 (MYPAGE_SERVICE_TERMS)
│               │   ├── 개인정보 처리방침 (MYPAGE_PRIVACY_POLICY)
│               │   └── 위치기반 서비스 약관 (MYPAGE_LOCATION_TERMS)
│               └── 계정 관리 (MYPAGE_ACCOUNT_MANAGE)
│                   ├── 로그아웃 확인 (MYPAGE_LOGOUT_CONFIRM)
│                   └── 회원 탈퇴 확인 (MYPAGE_WITHDRAW_CONFIRM)
└── 역할별 전용 (ROLE) - 권한 필요
    ├── 시설 운영자 전용
    ├── 지도자 전용
    └── 관리자 전용
```

### 2.2 접근 권한 구조
- **ALL**: 모든 사용자 접근 가능
- **로그인**: 로그인한 사용자만 접근 가능
- **비로그인**: 로그인하지 않은 사용자만 접근 가능
- **일반사용자**: 일반 사용자 권한
- **지도자**: 지도자 권한 (일반사용자 + 지도자 권한)
- **시설운영자**: 시설 운영자 권한 (일반사용자 + 시설운영자 권한)
- **통합파트너**: 지도자 + 시설운영자 권한 모두 보유
- **관리자**: 시스템 관리 권한

## 3. 인증 영역 (AUTH) 기능 정의

### 3.1 파트너 등록 (PARTNER_REGISTRATION) - NEW
**화면 ID**: PARTNER_REGISTRATION  
**계층 레벨**: 2  
**상위 화면**: 로그인 메인 페이지  
**하위 화면**: 기본정보입력, 약관동의, 사용자설정, 파트너타입선택  
**네비게이션 타입**: 스택네비게이션  
**접근 방식**: 파트너등록버튼  
**사용자 타입**: ALL  

#### 주요 기능
- 파트너 등록 통합 플로우 시작
- 일반 사용자 가입부터 시작하여 올피커 설정까지 진행
- 이후 파트너 타입 선택으로 분기
- 기존 사용자 정보 재사용 가능

#### 사용자 플로우
1. 기본 정보 입력 (PARTNER_SIGNUP_BASIC)
   - 이름 입력 (PARTNER_SIGNUP_NAME)
   - 이메일/전화번호 입력 및 인증 (PARTNER_SIGNUP_EMAIL_PHONE)
   - 비밀번호 설정 (PARTNER_SIGNUP_PASSWORD)
2. 약관 동의 (PARTNER_SIGNUP_TERMS)
3. 사용자 설정 (PARTNER_SIGNUP_USER_SETTING)
   - 닉네임 설정 (PARTNER_SIGNUP_NICKNAME)
   - 생년월일 입력 (PARTNER_SIGNUP_BIRTH)
   - 성별 선택 (PARTNER_SIGNUP_GENDER)
   - 거주지역 설정 (PARTNER_SIGNUP_LOCATION)
4. 파트너 타입 선택 (PARTNER_TYPE_SELECT)

#### 상세 설명
파트너 등록의 새로운 진입점으로, 일반 사용자 가입부터 시작하여 올피커 설정까지 완료한 후 파트너 타입을 선택하는 통합 플로우입니다. 기존 사용자 정보를 재사용할 수 있어 사용자 편의성을 높입니다.

### 3.2 파트너 타입 선택 (PARTNER_TYPE_SELECT) - NEW
**화면 ID**: PARTNER_TYPE_SELECT  
**계층 레벨**: 3  
**상위 화면**: 사용자 설정  
**하위 화면**: 지도자등록, 시설등록, 통합등록  
**네비게이션 타입**: 라디오버튼선택  
**접근 방식**: 다음버튼  
**사용자 타입**: 일반사용자  

#### 주요 기능
- 파트너 타입 선택 (지도자/시설/통합)
- 유료 전환 안내 팝업
- 선택에 따른 등록 플로우 분기

#### 선택 옵션
- **지도자 등록**: 지도자 파트너 등록
- **시설 운영자 등록**: 시설 운영자 파트너 등록  
- **통합 등록**: 지도자 + 시설 운영자 동시 등록

#### 상세 설명
사용자가 원하는 파트너 타입을 선택하는 화면입니다. 각 선택에 따라 적절한 등록 플로우로 안내하며, 유료 전환에 대한 안내 팝업을 제공합니다.

### 3.3 지도자 파트너 등록 (INSTRUCTOR_PARTNER_SIGNUP)
**화면 ID**: INSTRUCTOR_PARTNER_SIGNUP  
**계층 레벨**: 4  
**상위 화면**: 파트너 타입 선택  
**하위 화면**: 기본정보, 포트폴리오, 시설등록, 완료  
**네비게이션 타입**: 스택네비게이션  
**접근 방식**: 지도자등록선택  
**사용자 타입**: 일반사용자  

#### 주요 기능
- 지도자 기본 정보 + 자격 정보 업로드 통합
- 포트폴리오 작성
- 소속 시설 등록
- 등록 완료

#### 사용자 플로우
1. 기본 정보 + 자격 정보 업로드 (INSTRUCTOR_SIGNUP_INFO)
   - 개인 사업자 번호
   - 사업자등록증 업로드
   - 자격증 업로드
   - 유료 전환 안내 팝업
2. 포트폴리오 작성 (INSTRUCTOR_REGISTER_PORTFOLIO)
3. 소속 시설 등록 (INSTRUCTOR_REGISTER_FACILITY)
4. 등록 완료 (INSTRUCTOR_REGISTER_COMPLETE)

#### 상세 설명
지도자로 등록하기 위한 플로우로, 기존의 약관 동의 단계가 제거되고 기본 정보 입력 시 자격 정보를 함께 업로드합니다.

### 3.4 시설 운영자 파트너 등록 (FACILITY_PARTNER_SIGNUP)
**화면 ID**: FACILITY_PARTNER_SIGNUP  
**계층 레벨**: 4  
**상위 화면**: 파트너 타입 선택  
**하위 화면**: 기본정보, 시설등록, 운영시간, 완료  
**네비게이션 타입**: 스택네비게이션  
**접근 방식**: 시설등록선택  
**사용자 타입**: 일반사용자  

#### 주요 기능
- 시설 운영자 기본 정보 + 증빙서류 업로드 통합
- 시설 기본 정보 등록
- 운영 시간 설정
- 등록 완료

#### 사용자 플로우
1. 기본 정보 + 증빙서류 업로드 (FACILITY_OPERATOR_SIGNUP_INFO)
   - 대표자명
   - 사업자 번호
   - 사업자등록증 업로드
   - 시설 사진 업로드
   - 유료 전환 안내 팝업
2. 시설 등록 - 기본 정보 (FACILITY_OPERATOR_REGISTER_BASIC)
3. 운영 시간 설정 (FACILITY_OPERATOR_REGISTER_HOURS)
4. 등록 완료 (FACILITY_OPERATOR_REGISTER_COMPLETE)

#### 상세 설명
시설 운영자로 등록하기 위한 플로우로, 기존의 약관 동의 및 별도 증빙서류 업로드 단계가 제거되고 기본 정보 입력 시 증빙서류를 함께 업로드합니다.

### 3.5 지도자·시설 통합 등록 (INTEGRATED_PARTNER_SIGNUP) - NEW
**화면 ID**: INTEGRATED_PARTNER_SIGNUP  
**계층 레벨**: 4  
**상위 화면**: 파트너 타입 선택  
**하위 화면**: 지도자정보입력, 시설정보입력, 통합등록완료  
**네비게이션 타입**: 스택네비게이션  
**접근 방식**: 통합등록선택  
**사용자 타입**: 일반사용자  

#### 주요 기능
- 지도자와 시설 운영자를 동시에 등록
- 두 역할의 정보를 순차적으로 수집
- 통합 서류 관리

#### 사용자 플로우
1. 지도자 정보 입력 + 자격증 업로드 (INTEGRATED_INSTRUCTOR_INFO)
2. 시설 정보 입력 + 사업자등록증 업로드 (INTEGRATED_FACILITY_INFO)
3. 통합 등록 완료 (INTEGRATED_REGISTER_COMPLETE)

#### 상세 설명
지도자와 시설 운영자 역할을 동시에 등록할 수 있는 통합 플로우입니다. 두 역할의 정보를 순차적으로 수집하고, 각각의 서류를 업로드하여 통합 관리합니다.

### 3.6 일반 사용자 회원가입 (SIGNUP)
**화면 ID**: SIGNUP  
**계층 레벨**: 3  
**상위 화면**: 로그인 메인 페이지  
**하위 화면**: 기본정보입력, 약관동의, 사용자설정, 가입완료  
**네비게이션 타입**: 스택네비게이션  
**접근 방식**: 회원가입링크  
**사용자 타입**: ALL  

#### 주요 기능
- 일반 사용자 전용 회원가입
- 단계별 정보 입력
- 파트너 타입 선택 없음

#### 사용자 플로우
1. 기본 정보 입력 (SIGNUP_BASIC)
2. 약관 동의 (SIGNUP_TERMS)
3. 사용자 설정 (SIGNUP_USER_SETTING)
4. 가입 완료 (SIGNUP_COMPLETE)

#### 상세 설명
일반 사용자를 위한 단순화된 회원가입 플로우입니다. 파트너 등록과 달리 파트너 타입 선택 단계가 없습니다.

## 4. 메인 앱 (MAIN) 기능 정의

### 4.1 지도 탭 강화 (MAP_TAB) - ENHANCED
**화면 ID**: MAP_TAB  
**계층 레벨**: 2  
**상위 화면**: 메인 앱  
**하위 화면**: 지도뷰, 자기위치이동, 지도컨트롤, 시설정보  
**네비게이션 타입**: 탭네비게이션  
**접근 방식**: 지도탭클릭  
**사용자 타입**: ALL  

#### 주요 기능
- 지도 기반 시설 탐색
- 자기 위치 이동 기능 추가
- 지도 뷰 및 지도 컨트롤
- 시설 정보 표시

#### 하위 기능
- **지도 뷰**: 지도 표시 및 시설 마커
- **자기 위치 이동**: 사용자 현재 위치로 지도 이동
- **지도 컨트롤**: 줌, 팬 등 지도 조작
- **시설 정보**: 시설 상세 정보 표시

#### 상세 설명
지도를 통해 주변 시설을 시각적으로 탐색할 수 있는 탭입니다. 사용자의 현재 위치를 중심으로 주변 시설들을 지도에 표시하고, 새로 추가된 "자기 위치 이동" 기능으로 사용자가 현재 위치로 빠르게 이동할 수 있습니다.

### 4.2 자기 위치 이동 (MAP_MY_LOCATION) - NEW
**화면 ID**: MAP_MY_LOCATION  
**계층 레벨**: 3  
**상위 화면**: 지도 탭  
**하위 화면**: 없음  
**네비게이션 타입**: 버튼입력  
**접근 방식**: 자기위치버튼클릭  
**사용자 타입**: ALL  

#### 주요 기능
- 사용자의 현재 위치로 지도 중심 이동
- GPS 위치 재확인
- 위치 권한 요청 및 관리

#### 요구사항
- 위치 권한 필요
- GPS 센서 활용
- 지도 API 연동

#### 상세 설명
지도 화면에서 사용자의 현재 위치로 지도를 자동으로 이동시키는 기능입니다. GPS를 통해 현재 위치를 재확인하고, 해당 위치를 지도의 중심으로 설정하여 주변 시설을 쉽게 탐색할 수 있도록 합니다.

## 5. 역할 기반 권한 관리

### 5.1 다중 권한 지원
- **일반 사용자 (1)**: 기본 사용자 권한
- **지도자 (2)**: 지도자 권한 (일반사용자 + 지도자)
- **시설 운영자 (3)**: 시설 운영자 권한 (일반사용자 + 시설운영자)
- **통합 파트너**: 지도자 + 시설 운영자 권한 모두 보유 (1+2+3)
- **관리자**: 시스템 관리 권한

### 5.2 권한별 접근 제어
- **기본 기능**: 모든 로그인 사용자 (role = 1)
- **지도자 전용**: 지도자 권한 보유자 (role = 2)
- **시설 운영자 전용**: 시설 운영자 권한 보유자 (role = 3)
- **통합 파트너 전용**: 두 권한 모두 보유자 (role = 2,3)
- **관리자 전용**: 관리자 권한 보유자

## 6. 주요 변경사항

### 6.1 파트너 등록 통합
- **기존**: 지도자/시설 운영자 별도 회원가입
- **변경**: 통합 파트너 등록 플로우
- **장점**: 사용자 편의성 향상, 일관된 UX

### 6.2 약관 동의 간소화
- **기존**: 각 파트너 타입별 약관 동의 단계 존재
- **변경**: 회원가입 시 약관 동의 완료, 파트너 등록 시 제거
- **장점**: 등록 단계 감소, 사용자 이탈률 감소

### 6.3 증빙 서류 업로드 통합
- **기존**: 별도 증빙서류 업로드 단계
- **변경**: 기본 정보 입력 시 함께 업로드
- **장점**: 등록 단계 간소화, 프로세스 효율화

### 6.4 역할 기반 권한 관리
- **기존**: 단일 역할 (일반/지도자/시설운영자)
- **변경**: 다중 권한 지원 (1: 일반, 2: 지도자, 3: 시설운영자)
- **장점**: 유연한 권한 관리, 통합 파트너 지원

### 6.5 지도 기능 강화
- **기존**: 기본 지도 뷰
- **변경**: 자기 위치 이동 기능 추가
- **장점**: 사용자 편의성 향상, 위치 기반 서비스 개선

## 7. 기술적 요구사항

### 7.1 플랫폼 지원
- iOS 13.0 이상
- Android API 21 이상
- 반응형 디자인

### 7.2 외부 서비스 연동
- 카카오 로그인 API
- SMS 인증 서비스
- 지도 API (네이버/구글)
- 이미지 업로드 서비스
- GPS 위치 서비스

### 7.3 보안 요구사항
- JWT 기반 토큰 인증
- 역할 기반 접근 제어 (RBAC)
- 개인정보 암호화 저장
- HTTPS 통신 강제
- 입력 데이터 검증 및 Sanitization

### 7.4 성능 요구사항
- 이미지 레이지 로딩
- API 응답 캐싱
- 빠른 화면 전환
- 위치 기반 검색 최적화
- 지도 렌더링 최적화

---

*작성일: 2025년 1월*  
*버전: 2.1*  
*작성자: 김진석*  
*기반 문서: 1차 개발 기능 정의서 v1, DB 설계서 v2, API 명세서 v2*  
*개발 범위: 1차 개발 v2 - 파트너 등록 통합, 역할 기반 권한 관리, 지도 기능 강화*
